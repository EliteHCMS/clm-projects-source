import{l as U,bD as _,bX as Q,bE as k,bR as N,r as b,c as $,bC as p,_ as F,bW as I,p as q,t as R,v as m,d as o,bb as i,ag as O,an as W,a4 as g,ah as H,c1 as K,bJ as X,bK as G,bM as T,bL as Z,bP as M,b_ as E,bY as ee,aS as ae,c2 as te}from"./index.41d00351.js";import{a as le,Q as P,b as j,c as se}from"./QTabPanels.e9973ee2.js";import{Q as oe}from"./QBadge.dd721ce4.js";import{Q as S}from"./QTable.eb2af12a.js";import{e as B}from"./export-file.819425c9.js";import"./QMarkupTable.fad7f2fc.js";const{capitalize:w}=ee,A=e=>{const s=e[20]!==""?w(e[20]):"",f=e[22]!==""?w(e[22]):"",d=e[21]!==""?` ${w(e[21])}`:"",c=e[23]!==""?` ${w(e[23])}`:"";return`${f}${c}, ${s}${d}`},y=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,s)=>`${A(s.employee)}`,sortable:!0,sortOrder:"ad"},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?I.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],re=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,s)=>`${A(s.employee)}`,sortable:!0},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?I.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],ne=U({name:"Table",components:{},setup(){const e=_(),s=Q(),f=k(),{assignmentsForProject:d}=N(s),c=d,{active:u}=N(k()),{getAssignments:r}=Q(),Y=b(""),h=b(null),D=b(null),x=b(0),z=b(!1);r();const C=$(()=>{let t=[];return c.value.forEach(l=>{l[75].toLowerCase().includes(Y.value.toLowerCase())&&t.push(l)}),t=h.value?t.filter(l=>p(l[1].$d).tz("America/Chicago").format("MM/DD/YYYY")===p(h.value).tz("America/Chicago").format("MM/DD/YYYY")):t,t=D.value?t.filter(l=>l[68]===D.value):t,t.sort((l,n)=>l.employee[22]>n.employee[22]?1:-1).filter(l=>!l[112])}),J=$(()=>e.screen.lt.md?100:25),L=$(()=>[...new Map(d.value.map(t=>[t[68],t[68]])).values()]),V=$(()=>{const t=p().subtract(14,"day");return d.value.filter(l=>p(l[1].$d).isSameOrAfter(t)&&p(l[1].$d).isSameOrBefore(p())).sort((l,n)=>l.employee[22]>n.employee[22]?1:-1)});function v(t,l,n){let a=l!==void 0?l(t,n):t;return a=a==null?"":String(a),a=a.split('"').join('""'),`"${a}"`}return{columns:y,mobileColumns:re,rows:C,initialPagination:{rowsPerPage:J},separator:"vertical",projectStore:f,active:u,search:Y,startDateFilter:h,craftOptions:L,craftFilter:D,assignmentsForProject:d,tab:x,newArrivals:V,showEmployee:z,formatName:A,exportNewArrivals(){const t=[y.map(n=>v(n.label))].concat(V.value.map(n=>y.map(a=>v(typeof a.field=="function"?a.field(n):n[a.field===void 0?a.name:a.field],a.format,n)).join(","))).join(`\r
`);B(`${p().format("MM.DD.YYYY")} ${u.value[20]} New-Arrivals-Export.csv`,t,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},exportAllEmployees(){const t=[y.map(n=>v(n.label))].concat(C.value.map(n=>y.map(a=>v(typeof a.field=="function"?a.field(n):n[a.field===void 0?a.name:a.field],a.format,n)).join(","))).join(`\r
`);B(`${p().format("MM.DD.YYYY")} ${u.value[20]} All-Employees-Export.csv`,t,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}}}}),ie={class:"q-px-sm"},me={class:"row items-center"},de={class:"col-12 col-md-4 q-px-sm"},pe={class:"col-12 col-md-4 q-px-sm"},fe={class:"col-12 col-md-4 q-px-sm"},ce={class:"text-dark text-caption text-italic"},ue={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},be={class:"text-dark text-caption text-italic"},ge={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function ye(e,s,f,d,c,u){return q(),R("div",ie,[m("div",null,[m("div",null,[o(K,{class:"bg-info text-white shadow-2 rounded-borders"},{default:i(()=>[o(le,{modelValue:e.tab,"onUpdate:modelValue":s[0]||(s[0]=r=>e.tab=r),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:i(()=>[o(P,{name:0,label:e.$q.screen.gt.xs?"All Employees":"Employees"},null,8,["label"]),o(P,{name:1,label:"New Arrivals"},{default:i(()=>[e.newArrivals.length>0?(q(),O(oe,{key:0,color:"accent",floating:"",transparent:""},{default:i(()=>[W(g(e.newArrivals.length),1)]),_:1})):H("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(se,{modelValue:e.tab,"onUpdate:modelValue":s[4]||(s[4]=r=>e.tab=r),animated:""},{default:i(()=>[o(j,{class:"q-px-xs",name:0},{default:i(()=>[o(X,{flat:""},{default:i(()=>[o(G,{class:"q-pt-none"},{default:i(()=>[m("div",me,[m("div",de,[o(T,{dense:e.$q.screen.lt.md,modelValue:e.search,"onUpdate:modelValue":s[1]||(s[1]=r=>e.search=r),label:"Search"},null,8,["dense","modelValue"])]),m("div",pe,[o(T,{dense:e.$q.screen.lt.md,modelValue:e.startDateFilter,"onUpdate:modelValue":s[2]||(s[2]=r=>e.startDateFilter=r),label:"Arrival Date",type:"date","stack-label":""},null,8,["dense","modelValue"])]),m("div",fe,[o(Z,{dense:e.$q.screen.lt.md,label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.craftFilter,"onUpdate:modelValue":s[3]||(s[3]=r=>e.craftFilter=r),options:e.craftOptions,"use-chips":""},null,8,["dense","modelValue","options"])])])]),_:1})]),_:1}),o(S,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Employees":`Employees for ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.rows,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",ce,"(Total: "+g(e.rows.length)+" employees)",1),o(M,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportAllEmployees,disable:e.rows.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ue,[o(E,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1}),o(j,{class:"q-px-xs",name:1},{default:i(()=>[o(S,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Arrived Last 14 Days":`Arrived Last 14 Days at ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.newArrivals,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",be,"(Total: "+g(e.newArrivals.length)+" new arrivals)",1),o(M,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportNewArrivals,disable:e.newArrivals.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ge,[o(E,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1})]),_:1},8,["modelValue"])])])])}var ve=F(ne,[["render",ye],["__scopeId","data-v-8a8755b0"]]);const $e={name:"Arrivals",components:{employeesTable:ve},setup(){return{}}};function we(e,s,f,d,c,u){const r=ae("employees-table");return q(),O(te,{style:{"max-width":"100vw"}},{default:i(()=>[o(r)]),_:1})}var Ve=F($e,[["render",we]]);export{Ve as default};
