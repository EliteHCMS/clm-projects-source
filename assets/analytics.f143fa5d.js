import{l as b,bD as M,bR as q,bX as z,bE as R,r as $,o as L,w as E,c as _,cG as U,_ as x,p as h,t as f,v as e,ag as V,bb as d,d as r,F as C,aR as k,bJ as O,bK as Q,a4 as g,y as T,ah as A,aS as y,bC as W,c1 as I,c2 as J}from"./index.3419df76.js";import{Q as P,a as S,b as D,c as F}from"./QTabPanels.5ffb43e5.js";import{Q as N}from"./QMarkupTable.14ee6c0c.js";import{Q as G}from"./QSplitter.e43e2368.js";import{a as B,s as H}from"./analytics.3277395a.js";function o(s,l=document.body){if(typeof s!="string")throw new TypeError("Expected a string as propName");if(!(l instanceof Element))throw new TypeError("Expected a DOM element");return getComputedStyle(l).getPropertyValue(`--q-${s}`).trim()||null}const X=b({components:{},setup(){const s=M();s.loadingBar.setDefaults({color:"accent",size:"10px",position:"top"});const{assignmentsForProject:l}=q(z()),{projectCrafts:c}=q(R()),m=$(null),u=$(null),p=$(null),n=["bg-primary text-white","bg-info text-white","bg-accent text-dark","bg-dark text-white"];return L(async()=>{s.loadingBar.start(),l.value.length>0&&(u.value=await B.calcRateData({assignments:l.value.filter(t=>!t[112]),projectCrafts:c.value}),m.value=u.value[0][3]),s.loadingBar.stop()}),E(l,async()=>{p.value=null,s.loadingBar.start(),l.value.length>0&&(u.value=await B.calcRateData({assignments:l.value.filter(t=>!t[112]),projectCrafts:c.value}),m.value=u.value[0][3]),s.loadingBar.stop()}),E(p,async(t,i)=>{p.value&&console.log(p.value)}),{craftWageArray:_(()=>u.value?u.value:[]),colors:n,clickedCraft:p,tab:m,splitValue:$(20),helpers:U}}}),K={class:"row text-caption"},Y={class:"col-12 col-md-2"},Z=e("div",null,[e("span",{class:"text-accent"},"Total Employees:")],-1),j={class:"text-white q-ml-sm"},ee={class:"col-12 col-md-2"},te=e("div",null,[e("span",{class:"text-accent"},"Classifications:")],-1),se={class:"text-white q-ml-sm"},ae={class:"col-12 col-md-2"},ne=e("div",null,[e("span",{class:"text-accent"},"Avg. Wage:")],-1),oe={class:"text-white q-ml-sm"},le={class:"col-12 col-md-2"},re=e("div",null,[e("span",{class:"text-accent"},"Avg. Craft Wage:")],-1),ce={class:"text-white q-ml-sm"},ie={class:"col-12 col-md-3"},ue=e("div",null,[e("span",{class:"text-accent"},"Wage Status")],-1),de={class:"text-white q-ml-sm"},pe=e("thead",{class:"bg-dark text-white"},[e("tr",null,[e("th",{class:"text-left"},"Job Title"),e("th",{class:"text-right"},"# of Employees"),e("th",{class:"text-right"},"Fixed Rate"),e("th",{class:"text-right"},"Average Rate"),e("th",{class:"text-right"},"Difference")])],-1),he=["onClick"],_e={class:"text-left"},me={class:"text-right"},fe={class:"text-right"},ge={class:"text-right"},ve={class:"text-right"},ye={key:1},$e=e("td",{colspan:"100%",class:"text-center"},"No classifications to show",-1),be=[$e],xe={key:2},qe={colspan:"100%"},we=e("thead",{class:"bg-dark text-white"},[e("tr",null,[e("th",{class:"text-left"},"Name"),e("th",{class:"text-left"},"Employee ID"),e("th",{class:"text-left"},"Payroll ID"),e("th",{class:"text-left"},"Job Number"),e("th",{class:"text-right"},"Rate")])],-1),Ce={class:"text-left"},Re={class:"text-left"},ke={class:"text-left"},We={class:"text-left"},Ve={class:"text-right"},Oe={key:1},Qe=e("div",{class:"text-h6"},"Not available on mobile yet.",-1),Ae=[Qe];function De(s,l,c,m,u,p){return h(),f("div",null,[e("div",null,[s.$q.screen.gt.sm&&s.craftWageArray?(h(),V(G,{key:0,modelValue:s.splitValue,"onUpdate:modelValue":l[2]||(l[2]=n=>s.splitValue=n)},{before:d(()=>[r(S,{modelValue:s.tab,"onUpdate:modelValue":l[0]||(l[0]=n=>s.tab=n),vertical:s.$q.screen.gt.md,align:"left","indicator-color":"accent","active-bg-color":"dark","active-color":"white"},{default:d(()=>[(h(!0),f(C,null,k(s.craftWageArray,n=>(h(),V(P,{key:n[3],name:n[3],label:n[10]},null,8,["name","label"]))),128))]),_:1},8,["modelValue","vertical"])]),after:d(()=>[r(F,{modelValue:s.tab,"onUpdate:modelValue":l[1]||(l[1]=n=>s.tab=n),animated:"",vertical:s.$q.screen.gt.md},{default:d(()=>[(h(!0),f(C,null,k(s.craftWageArray,n=>(h(),V(D,{key:n[3],name:n[3],class:"q-pt-none"},{default:d(()=>[e("div",null,[r(O,{class:"q-mb-md bg-dark"},{default:d(()=>[r(Q,{class:"q-pa-sm"},{default:d(()=>[e("div",K,[e("div",Y,[Z,e("div",null,[e("span",j,g(n.craftRoster.length),1)])]),e("div",ee,[te,e("div",null,[e("span",se,g(n.classifications.length),1)])]),e("div",ae,[ne,e("div",null,[e("span",oe,"$"+g(n.avgWage.toFixed(2)),1)])]),e("div",le,[re,e("div",null,[e("span",ce,"$"+g(n.avgCraftWorkerWage.toFixed(2)),1)])]),e("div",ie,[ue,e("div",null,[e("span",de,g(n.highWages?`${n.highWageCount} with High Wages`:"Good"),1)])])])]),_:2},1024)]),_:2},1024),r(N,null,{default:d(()=>[pe,e("tbody",null,[(h(!0),f(C,null,k(n.classifications,a=>(h(),f(C,{key:a[3]},[a?(h(),f("tr",{key:0,class:T(["cursor-pointer",a.analytics.highWages?"bg-negative text-white":""]),onClick:t=>a.expanded=!a.expanded},[e("td",_e,g(a[18]),1),e("td",me,g(a.analytics.roster.length),1),e("td",fe,g(a.analytics.fixedWage>0?`$${a.analytics.fixedWage.toFixed(2)}`:"N/A"),1),e("td",ge,g(a.analytics.avgWage>0?`$${a.analytics.avgWage.toFixed(2)}`:"N/A"),1),e("td",ve,g(a.analytics.avgWage>0&&a.analytics.fixedWage>0?`${a.analytics.diff>0?"+":""}${a.analytics.diff}`:"N/A"),1)],10,he)):A("",!0),a?A("",!0):(h(),f("tr",ye,be)),a.expanded?(h(),f("tr",xe,[e("td",qe,[r(N,{dense:""},{default:d(()=>[we,e("tbody",null,[(h(!0),f(C,null,k(a.analytics.roster,t=>(h(),f("tr",{key:t[3],class:T(t[116]>a.analytics.fixedWage&&a.analytics.fixedWage>0?"bg-accent":"")},[e("td",Ce,g(s.helpers.formatName(t[75])),1),e("td",Re,g(t.employee[378]),1),e("td",ke,g(t.employee[213]===""?"N/A":t.employee[213]),1),e("td",We,g(t[105]),1),e("td",Ve,"$"+g(t[116].toFixed(2)),1)],2))),128))])]),_:2},1024)])])):A("",!0)],64))),128))])]),_:2},1024)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","vertical"])]),_:1},8,["modelValue"])):(h(),f("div",Oe,Ae))])])}var Ee=x(X,[["render",De]]);const Te=b({setup(){const{active:s}=q(R()),l=_(()=>s.value.openRequests.concat(s.value.closedRequests.concat(s.value.pendingRequests)).sort((t,i)=>t[1].$d>i[1].$d?1:-1)),c=_(()=>{const a=[...new Map(l.value.map(t=>[t[282],{type:t[282]}])).values()];return a.forEach(t=>{Object.assign(t,{count:l.value.filter(i=>i[282]===t.type).length})}),a}),m=_(()=>c.value.map(a=>a.type)),u=_(()=>c.value.map(a=>a.count)),p={title:{text:"Request Type",align:"center",style:{color:o("primary"),fontWeight:"regular"}},labels:m.value,dataLabels:{enabled:!0},colors:[o("primary"),o("accent"),o("info"),o("secondary")],legend:{show:!0,position:"bottom",horizontalAlign:"center"},plotOptions:{expandOnClick:!0},stroke:{show:!1}},n=_(()=>({}));return{getCssVar:o,options:p,series:u,echartOptions:n}}});function Ne(s,l,c,m,u,p){const n=y("apexchart");return h(),f("div",null,[r(O,{class:"q-ma-sm chart-wrapper"},{default:d(()=>[r(Q,null,{default:d(()=>[r(n,{height:"auto",type:"pie",options:s.options,series:s.series},null,8,["options","series"])]),_:1})]),_:1})])}var Be=x(Te,[["render",Ne]]);const Pe=b({setup(){const{active:s}=q(R()),l=_(()=>s.value.openRequests.concat(s.value.closedRequests.concat(s.value.pendingRequests)).sort((a,t)=>a[1].$d>t[1].$d?1:-1)),c=_(()=>{const n=[...new Map(l.value.map(a=>[a[284],{type:a[284]}])).values()];return n.forEach(a=>{Object.assign(a,{count:l.value.filter(t=>t[284]===a.type).length})}),n}),m=_(()=>c.value.map(n=>n.type)),u=_(()=>c.value.map(n=>n.count)),p={title:{text:"Request Reason",align:"center",style:{color:o("primary"),fontWeight:"regular"}},labels:m.value,dataLabels:{enabled:!0},colors:[o("accent"),o("primary"),o("info"),o("secondary")],legend:{show:!0,position:"bottom",horizontalAlign:"center"},plotOptions:{expandOnClick:!0},stroke:{show:!1}};return{getCssVar:o,options:p,series:u}}});function Se(s,l,c,m,u,p){const n=y("apexchart");return h(),f("div",null,[r(O,{class:"q-ma-sm chart-wrapper"},{default:d(()=>[r(Q,null,{default:d(()=>[r(n,{height:"auto",type:"pie",options:s.options,series:s.series},null,8,["options","series"])]),_:1})]),_:1})])}var Fe=x(Pe,[["render",Se]]);const Me=[o("info"),o("accent"),o("primary"),o("secondary"),o("dark"),o("negative"),o("positive"),o("cyan"),o("green"),o("amber"),o("blue-grey"),o("teal")],ze=b({components:{},setup(){const{active:s}=q(R()),l=_(()=>{const t=[];return s.value.openRequests.concat(s.value.closedRequests.concat(s.value.pendingRequests)).sort((v,w)=>v[1].$d>w[1].$d?1:-1).forEach(v=>{v.classes.forEach(w=>{t.push(w)})}),t.filter(v=>v.isCraft).sort((v,w)=>v[246]>w[246]?1:-1)}),c=_(()=>{const t=[...new Map(l.value.map(i=>[i[43],{type:i[43],id:i[244]}])).values()];return t.forEach(i=>{Object.assign(i,{count:H(l.value.filter(v=>v[244]===i.id).map(v=>v[18]))})}),t}),m=_(()=>c.value.map(t=>t.type)),u=_(()=>c.value.map(t=>t.count)),p={title:{text:"Requested Quantity by Craft",align:"center",style:{color:o("primary")}},labels:m.value,dataLabels:{enabled:!0},colors:[o("info"),o("accent"),o("primary"),o("secondary"),o("dark"),o("negative"),o("positive"),o("cyan"),o("green"),o("amber"),o("blue-grey"),o("teal")],legend:{show:!1,position:"bottom",horizontalAlign:"center"},plotOptions:{expandOnClick:!0},stroke:{show:!1}},n=_(()=>({chartOptions:{title:{text:"Requested Quantity by Craft",align:"center",style:{color:o("primary"),fontWeight:"regular"}},chart:{type:"bar"},plotOptions:{bar:{horizontal:!0,distributed:!1,colors:{},dataLabels:{position:"center"}}}},series:[{data:c.value.map((i,v)=>({y:i.count,x:i.type,fillColor:Me[v]})).filter(i=>i.y>0)}]})),a=_(()=>({title:{text:"Requested Quantity by Craft",left:"center"},tooltip:{trigger:"item"},series:[{radius:"50%",type:"pie",label:{show:!1},emphasis:{emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},data:c.value.map(i=>({value:i.count,name:i.type}))}]}));return{getCssVar:o,options:p,series:u,echartOptions:a,barOptions:n}}});function Le(s,l,c,m,u,p){const n=y("apexchart");return h(),f("div",null,[r(O,{class:"q-ma-sm chart-wrapper"},{default:d(()=>[r(Q,null,{default:d(()=>[r(n,{height:"auto",options:s.barOptions.chartOptions,series:s.barOptions.series},null,8,["options","series"])]),_:1})]),_:1})])}var Ue=x(ze,[["render",Le],["__scopeId","data-v-1795400e"]]);const Ie=b({components:{RequestTypeChart:Be,RequestReasonChart:Fe,QuantityPerCraftChart:Ue},setup(){const s=$(W("2022-01-01")),l=$(W()),{active:c}=q(R()),m=$(null),u=_(()=>c.value.openRequests.concat(c.value.closedRequests).filter(t=>W(t[1].$d).isAfter(s.value)&&W(t[1].$d).isSameOrBefore(l.value)).sort((t,i)=>t[1].$d>i[1].$d?1:-1)),p=_(()=>c.value.crafts),n=_(()=>{const a=[...new Map(u.value.map(t=>[t[282],{type:t[282]}])).values()];return a.forEach(t=>{Object.assign(t,{count:u.value.filter(i=>i[282]===t.type).length})}),a});return{start:s,end:l,requestData:m,allRequests:u,allCrafts:p,requestTypeData:n}}}),Je={class:"row"},Ge={class:"col-12 col-md-7 q-px-xs"},He={class:"col-12 col-md-5 q-px-xs"},Xe={class:"row justify-end"},Ke={class:"col-12 col-md-12 q-px-lg"};function Ye(s,l,c,m,u,p){const n=y("quantity-per-craft-chart"),a=y("request-type-chart"),t=y("request-reason-chart");return h(),f("div",null,[e("div",Je,[e("div",Ge,[r(n)]),e("div",He,[e("div",Xe,[e("div",Ke,[r(a),r(t)])])])])])}var Ze=x(Ie,[["render",Ye]]);const je=b({components:{RatesPanel:Ee,RequestsPanel:Ze},setup(){return{tab:$(0)}}}),et={class:"q-px-sm"};function tt(s,l,c,m,u,p){const n=y("rates-panel"),a=y("requests-panel");return h(),f("div",et,[r(I,{class:"bg-info text-white shadow-2 rounded-borders"},{default:d(()=>[r(S,{modelValue:s.tab,"onUpdate:modelValue":l[0]||(l[0]=t=>s.tab=t),"bg-color":"none","indicator-color":"accent"},{default:d(()=>[r(P,{name:0,label:"Rates"})]),_:1},8,["modelValue"])]),_:1}),r(F,{modelValue:s.tab,"onUpdate:modelValue":l[1]||(l[1]=t=>s.tab=t),animated:""},{default:d(()=>[r(D,{name:0},{default:d(()=>[r(n)]),_:1}),r(D,{name:1},{default:d(()=>[r(a)]),_:1})]),_:1},8,["modelValue"])])}var st=x(je,[["render",tt]]);const at=b({name:"Analytics",components:{Dash:st},setup(){return{}}});function nt(s,l,c,m,u,p){const n=y("dash");return h(),V(J,{style:{"max-width":"100vw"}},{default:d(()=>[r(n)]),_:1})}var ut=x(at,[["render",nt]]);export{ut as default};
