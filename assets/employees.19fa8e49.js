import{l as J,bI as _,c0 as V,bJ as N,bW as Q,r as y,c as D,c4 as b,_ as L,b$ as x,p as Y,t as W,v as m,d as o,bb as d,ag as I,an as H,a4 as v,ah as G,c7 as K,bO as X,bP as Z,bR as j,bQ as ee,bU as E,c3 as M,c1 as ae,aS as te,c8 as le}from"./index.9b2fd398.js";import{a as se,Q as P,d as oe,b as B,c as re}from"./QBadge.d9ccf65f.js";import{a as S}from"./QTable.77de07e2.js";function O(e){setTimeout(()=>{window.URL.revokeObjectURL(e.href)},1e4),e.remove()}function U(e,a,p={}){const{mimeType:c,byteOrderMark:f,encoding:u}=typeof p=="string"?{mimeType:p}:p,l=u!==void 0?new TextEncoder(u).encode([a]):a,$=f!==void 0?[f,l]:[l],g=new Blob($,{type:c||"application/octet-stream"}),i=document.createElement("a");i.href=window.URL.createObjectURL(g),i.setAttribute("download",e),typeof i.download=="undefined"&&i.setAttribute("target","_blank"),i.classList.add("hidden"),i.style.position="fixed",document.body.appendChild(i);try{return i.click(),O(i),!0}catch(A){return O(i),A}}const{capitalize:q}=ae,C=e=>{const a=e[20]!==""?q(e[20]):"",p=e[22]!==""?q(e[22]):"",c=e[21]!==""?` ${q(e[21])}`:"",f=e[23]!==""?` ${q(e[23])}`:"";return`${p}${f}, ${a}${c}`},w=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,a)=>`${C(a.employee)}`,sortable:!0,sortOrder:"ad"},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?x.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],ne=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,a)=>`${C(a.employee)}`,sortable:!0},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?x.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],ie=J({name:"Table",components:{},setup(){const e=_(),a=V(),p=N(),{assignmentsForProject:c}=Q(a),f=c,{active:u}=Q(N()),{getAssignments:l}=V(),$=y(""),g=y(null),i=y(null),A=y(0),R=y(!1);l();const k=D(()=>{let s=[];return f.value.forEach(r=>{r[75].toLowerCase().includes($.value.toLowerCase())&&s.push(r)}),s=g.value?s.filter(r=>b(r[1].$d).tz("America/Chicago").format("MM/DD/YYYY")===b(g.value).tz("America/Chicago").format("MM/DD/YYYY")):s,s=i.value?s.filter(r=>r[68]===i.value):s,s.sort((r,n)=>r.employee[22]>n.employee[22]?1:-1)}),F=D(()=>e.screen.lt.md?100:25),z=D(()=>[...new Map(c.value.map(s=>[s[68],s[68]])).values()]),T=D(()=>{const s=b().subtract(14,"day");return c.value.filter(r=>b(r[1].$d).isSameOrAfter(s)&&b(r[1].$d).isSameOrBefore(b())).sort((r,n)=>r.employee[22]>n.employee[22]?1:-1)});function h(s,r,n){let t=r!==void 0?r(s,n):s;return t=t==null?"":String(t),t=t.split('"').join('""'),`"${t}"`}return{columns:w,mobileColumns:ne,rows:k,initialPagination:{rowsPerPage:F},separator:"vertical",projectStore:p,active:u,search:$,startDateFilter:g,craftOptions:z,craftFilter:i,assignmentsForProject:c,tab:A,newArrivals:T,showEmployee:R,formatName:C,exportNewArrivals(){const s=[w.map(n=>h(n.label))].concat(T.value.map(n=>w.map(t=>h(typeof t.field=="function"?t.field(n):n[t.field===void 0?t.name:t.field],t.format,n)).join(","))).join(`\r
`);U(`${b().format("MM.DD.YYYY")} ${u.value[20]} New-Arrivals-Export.csv`,s,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},exportAllEmployees(){const s=[w.map(n=>h(n.label))].concat(k.value.map(n=>w.map(t=>h(typeof t.field=="function"?t.field(n):n[t.field===void 0?t.name:t.field],t.format,n)).join(","))).join(`\r
`);U(`${b().format("MM.DD.YYYY")} ${u.value[20]} All-Employees-Export.csv`,s,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}}}}),de={class:"q-px-sm"},me={class:"row items-center"},ce={class:"col-12 col-md-4 q-px-sm"},pe={class:"col-12 col-md-4 q-px-sm"},fe={class:"col-12 col-md-4 q-px-sm"},ue={class:"text-dark text-caption text-italic"},be={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},ge={class:"text-dark text-caption text-italic"},ye={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function ve(e,a,p,c,f,u){return Y(),W("div",de,[m("div",null,[m("div",null,[o(K,{class:"bg-info text-white shadow-2 rounded-borders"},{default:d(()=>[o(se,{modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=l=>e.tab=l),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:d(()=>[o(P,{name:0,label:e.$q.screen.gt.xs?"All Employees":"Employees"},null,8,["label"]),o(P,{name:1,label:"New Arrivals"},{default:d(()=>[e.newArrivals.length>0?(Y(),I(oe,{key:0,color:"accent",floating:"",transparent:""},{default:d(()=>[H(v(e.newArrivals.length),1)]),_:1})):G("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(re,{modelValue:e.tab,"onUpdate:modelValue":a[4]||(a[4]=l=>e.tab=l),animated:""},{default:d(()=>[o(B,{class:"q-px-xs",name:0},{default:d(()=>[o(X,{flat:""},{default:d(()=>[o(Z,{class:"q-pt-none"},{default:d(()=>[m("div",me,[m("div",ce,[o(j,{dense:e.$q.screen.lt.md,modelValue:e.search,"onUpdate:modelValue":a[1]||(a[1]=l=>e.search=l),label:"Search"},null,8,["dense","modelValue"])]),m("div",pe,[o(j,{dense:e.$q.screen.lt.md,modelValue:e.startDateFilter,"onUpdate:modelValue":a[2]||(a[2]=l=>e.startDateFilter=l),label:"Arrival Date",type:"date","stack-label":""},null,8,["dense","modelValue"])]),m("div",fe,[o(ee,{dense:e.$q.screen.lt.md,label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.craftFilter,"onUpdate:modelValue":a[3]||(a[3]=l=>e.craftFilter=l),options:e.craftOptions,"use-chips":""},null,8,["dense","modelValue","options"])])])]),_:1})]),_:1}),o(S,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Employees":`Employees for ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.rows,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":d(()=>[m("div",ue,"(Total: "+v(e.rows.length)+" employees)",1),o(E,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportAllEmployees,disable:e.rows.length<1},null,8,["dense","onClick","disable"])]),"no-data":d(({message:l})=>[m("div",be,[o(M,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,v(l),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1}),o(B,{class:"q-px-xs",name:1},{default:d(()=>[o(S,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Arrived Last 14 Days":`Arrived Last 14 Days at ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.newArrivals,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":d(()=>[m("div",ge,"(Total: "+v(e.newArrivals.length)+" new arrivals)",1),o(E,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportNewArrivals,disable:e.newArrivals.length<1},null,8,["dense","onClick","disable"])]),"no-data":d(({message:l})=>[m("div",ye,[o(M,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,v(l),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1})]),_:1},8,["modelValue"])])])])}var we=L(ie,[["render",ve],["__scopeId","data-v-ef9cdca6"]]);const $e={name:"Arrivals",components:{employeesTable:we},setup(){return{}}};function he(e,a,p,c,f,u){const l=te("employees-table");return Y(),I(le,{style:{"max-width":"100vw"}},{default:d(()=>[o(l)]),_:1})}var Ye=L($e,[["render",he]]);export{Ye as default};
