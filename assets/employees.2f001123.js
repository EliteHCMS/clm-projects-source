import{l as R,bD as W,bX as k,bE as Q,bR as N,r as b,c as w,bC as c,_ as x,bW as L,p as q,t as H,v as m,d as o,bb as i,ag as _,an as K,a4 as g,ah as X,c1 as G,bJ as Z,bK as ee,bM as T,bL as ae,bP as M,b_ as j,bY as te,aS as le,c2 as se}from"./index.2a579734.js";import{a as oe,Q as E,b as P,c as re}from"./QTabPanels.a108f63c.js";import{Q as ne}from"./QBadge.498267b9.js";import{Q as S}from"./QTable.bd8c3355.js";import{e as B}from"./export-file.819425c9.js";import"./QMarkupTable.785cf40e.js";const{capitalize:$}=te,C=e=>{const s=e[20]!==""?$(e[20].toLowerCase().trim()):"",f=e[22]!==""?$(e[22].toLowerCase().trim()):"",d=e[21]!==""?` ${$(e[21].toLowerCase().trim())}`:"",u=e[23]!==""?` ${$(e[23])}`:"";return`${f}${u}, ${s}${d}`},y=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,s)=>`${C(s.employee)}`,sortable:!0,sortOrder:"ad"},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?L.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],ie=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,s)=>`${C(s.employee)}`,sortable:!0},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?L.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],me=R({name:"Table",components:{},setup(){const e=W(),s=k(),f=Q(),{assignmentsForProject:d}=N(s),u=d,{active:p}=N(Q()),{getAssignments:r,checkDisa:F}=k(),Y=b(""),h=b(null),D=b(null),I=b(0),O=b(!1);r();const A=w(()=>{let a=[];return u.value.forEach(l=>{l[75].toLowerCase().includes(Y.value.toLowerCase())&&a.push(l)}),a=h.value?a.filter(l=>c(l[1].$d).tz("America/Chicago").format("MM/DD/YYYY")===c(h.value).tz("America/Chicago").format("MM/DD/YYYY")):a,a=D.value?a.filter(l=>l[68]===D.value):a,a.sort((l,n)=>l.employee[22]>n.employee[22]?1:-1).filter(l=>!l[112])}),z=w(()=>e.screen.lt.md?100:25),J=w(()=>[...new Map(d.value.map(a=>[a[68],a[68]])).values()]),V=w(()=>{const a=c().subtract(14,"day");return d.value.filter(l=>c(l[1].$d).isSameOrAfter(a)&&c(l[1].$d).isSameOrBefore(c())).sort((l,n)=>l.employee[22]>n.employee[22]?1:-1)});function v(a,l,n){let t=l!==void 0?l(a,n):a;return t=t==null?"":String(t),t=t.split('"').join('""'),`"${t}"`}console.log(d.value.filter(a=>!a[112]));async function U(){const a=await F({project:p.value,roster:A.value});console.log(a)}return{columns:y,mobileColumns:ie,rows:A,initialPagination:{rowsPerPage:z},separator:"vertical",projectStore:f,active:p,search:Y,startDateFilter:h,craftOptions:J,craftFilter:D,assignmentsForProject:d,tab:I,newArrivals:V,showEmployee:O,formatName:C,exportNewArrivals(){const a=[y.map(n=>v(n.label))].concat(V.value.map(n=>y.map(t=>v(typeof t.field=="function"?t.field(n):n[t.field===void 0?t.name:t.field],t.format,n)).join(","))).join(`\r
`);B(`${c().format("MM.DD.YYYY")} ${p.value[20]} New-Arrivals-Export.csv`,a,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},exportAllEmployees(){const a=[y.map(n=>v(n.label))].concat(A.value.map(n=>y.map(t=>v(typeof t.field=="function"?t.field(n):n[t.field===void 0?t.name:t.field],t.format,n)).join(","))).join(`\r
`);B(`${c().format("MM.DD.YYYY")} ${p.value[20]} All-Employees-Export.csv`,a,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},checkDisaStatus:U}}}),de={class:"q-px-sm"},ce={class:"row items-center"},pe={class:"col-12 col-md-4 q-px-sm"},fe={class:"col-12 col-md-4 q-px-sm"},ue={class:"col-12 col-md-4 q-px-sm"},be={class:"text-dark text-caption text-italic"},ge={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},ye={class:"text-dark text-caption text-italic"},ve={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function we(e,s,f,d,u,p){return q(),H("div",de,[m("div",null,[m("div",null,[o(G,{class:"bg-info text-white shadow-2 rounded-borders"},{default:i(()=>[o(oe,{modelValue:e.tab,"onUpdate:modelValue":s[0]||(s[0]=r=>e.tab=r),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:i(()=>[o(E,{name:0,label:e.$q.screen.gt.xs?"All Employees":"Employees"},null,8,["label"]),o(E,{name:1,label:"New Arrivals"},{default:i(()=>[e.newArrivals.length>0?(q(),_(ne,{key:0,color:"accent",floating:"",transparent:""},{default:i(()=>[K(g(e.newArrivals.length),1)]),_:1})):X("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(re,{modelValue:e.tab,"onUpdate:modelValue":s[4]||(s[4]=r=>e.tab=r),animated:""},{default:i(()=>[o(P,{class:"q-px-xs",name:0},{default:i(()=>[o(Z,{flat:""},{default:i(()=>[o(ee,{class:"q-pt-none"},{default:i(()=>[m("div",ce,[m("div",pe,[o(T,{dense:"",modelValue:e.search,"onUpdate:modelValue":s[1]||(s[1]=r=>e.search=r),label:"Search"},null,8,["modelValue"])]),m("div",fe,[o(T,{dense:"",modelValue:e.startDateFilter,"onUpdate:modelValue":s[2]||(s[2]=r=>e.startDateFilter=r),label:"Arrival Date",type:"date","stack-label":""},null,8,["modelValue"])]),m("div",ue,[o(ae,{dense:"",label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.craftFilter,"onUpdate:modelValue":s[3]||(s[3]=r=>e.craftFilter=r),options:e.craftOptions,"use-chips":""},null,8,["modelValue","options"])])])]),_:1})]),_:1}),o(S,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Employees":`Employees for ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.rows,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",be,"(Total: "+g(e.rows.length)+" employees)",1),o(M,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportAllEmployees,disable:e.rows.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ge,[o(j,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1}),o(P,{class:"q-px-xs",name:1},{default:i(()=>[o(S,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Arrived Last 14 Days":`Arrived Last 14 Days at ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.newArrivals,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",ye,"(Total: "+g(e.newArrivals.length)+" new arrivals)",1),o(M,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportNewArrivals,disable:e.newArrivals.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ve,[o(j,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1})]),_:1},8,["modelValue"])])])])}var $e=x(me,[["render",we],["__scopeId","data-v-69611ee4"]]);const he={name:"Arrivals",components:{employeesTable:$e},setup(){return{}}};function De(e,s,f,d,u,p){const r=le("employees-table");return q(),_(se,{style:{"max-width":"100vw"}},{default:i(()=>[o(r)]),_:1})}var Qe=x(he,[["render",De]]);export{Qe as default};
