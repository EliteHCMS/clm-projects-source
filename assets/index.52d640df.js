import{bp as H,b0 as b,bm as A,a_ as V,q as g,bq as M,l as E,a$ as B,r as y,w as O,_ as F,p as c,t as w,v as l,S as _,U as r,d as n,a1 as D,$ as d,W as S,Z as Q,aS as h,F as Y,V as K,br as W,aI as Z,aH as J,o as tt,c as et,y as X,aP as st,ac as at,b2 as ot,bo as P,N as nt,a3 as j,a4 as lt}from"./index.4e4a8e4c.js";const it=25,q=H("assessment",{state:()=>({step:0,loading:!0,tools:[],testData:{allQuestions:[],selectedQuestions:[],completedQuestions:[],nextQuestions:null,testStatus:"In Progress",currentScope:0,loadIteration:0,qb:{testRecord:{3:{field:"Record ID#",value:24712},6:{field:"Related Kiosk Profile"},13:{field:"Related Hiring Center"},15:{field:"Related Employee"},17:{field:"Related Craft"},23:{field:"Related Available Language"},34:{field:"Test Completion Timestamp"},37:{field:"Test Status"},testQuestions:[{6:{field:"Related Test"},7:{field:"Related All Test Question"},11:{field:"Status"},questionResponse:[{6:{field:"Related Test Question"},8:{field:"Related Question Alternative"}}]}]}}},testId:null,qb:null,questions:[],answers:[],toolListId:null}),getters:{questionsLoaded(){return this.testData.allQuestions.length>0},nextQuestions(){return this.testData.nextQuestions?this.testData.nextQuestions:null},completedOnIteration(){return this.testData.completedQuestions.filter(t=>t.iteration===this.testData.loadIteration)},algo(){const t=this.testData.completedQuestions.filter(s=>s.selection[14]===1&&s.iteration===this.testData.loadIteration);return t!==void 0?t:[]},ratio(){return isNaN(this.algo.length/this.completedOnIteration.length)?0:(this.algo.length/this.completedOnIteration.length).toFixed(2)},nextScope(){return this.completedOnIteration.length>0?this.ratio>.6?this.testData.currentScope<6?this.testData.currentScope+1:this.testData.currentScope:this.ratio===.6?this.testData.currentScope:this.testData.currentScope>2?this.testData.currentScope-1:this.testData.currentScope:this.testData.currentScope},nextIteration(){return this.testData.loadIteration+1},timeToStop(){const t=this.testData.completedQuestions.filter(e=>e[23]>this.testData.currentScope).length,s=this.testData.completedQuestions.filter(e=>e[23]<this.testData.currentScope).length;return t>0&&s>0&&this.testData.completedQuestions.length>=it},toolChecklistData(){const{hiringCenter:t,testForCraft:s}=b(),{employeeData:e}=A(),a={6:{value:this.testId?this.testId:0},11:{value:t[3]?t[3].value:0},15:{value:e[3]?e[3]:0},20:{value:s[15]?s[15]:0},22:{value:s[16]?s[16]:0}};return{to:"bp3gcpk2w",data:[a],fieldsToReturn:[3]}},toolsData(){const t=[];return this.tools.length>0&&this.tools.forEach(s=>{const e={6:{value:this.toolListId?this.toolListId:0},7:{value:s.value}};t.push(e)}),{to:"bp928wac2",data:t,fieldsToReturn:[3]}}},actions:{async startAssessment(){const{profile:t}=V(),{hiringCenter:s,testForCraft:e}=b(),{employeeData:a,updateEmployeeData:o}=A(),u={13:{value:s[3].value},15:{value:a[3]},17:{value:e[15]},23:{value:e[16]},51:{value:e[3]}};t[3]!==void 0&&Object.assign(u,{6:{value:t[3].value}});const{data:i}=await g.upsertRecordsXML({to:"bp3gckirf",data:[u],fieldsToReturn:[3]});if(i[0])return this.testId=i[0][3],o({fields:{122:{value:8}}}),i[0];throw"Something went wrong"},async finishAssessment(){const{metadata:t}=await g.upsertRecordsXML({to:"bp3gckirf",data:[{3:{value:this.testId},34:{value:new Date},37:{value:"Complete"}}],mergeFieldId:3,fieldsToReturn:[3]});if(t.updatedRecordIds[0]){const{data:s}=await g.upsertRecordsXML({to:"bp9np6ckn",data:this.questions,fieldsToReturn:[3,7]});if(!s.length>0)throw"Cannot save questions";{const e=[];s.forEach(o=>{const u=this.answers.findIndex(i=>i.link===o[7]);if(u>-1){const i={6:{value:o[3]},8:{value:this.answers[u][8]}};e.push(i)}});const{metadata:a}=await g.upsertRecordsXML({to:"bp9np9vk7",data:e,fieldsToReturn:[3]});if(!a.createdRecordIds.length===this.answers.length)throw"Something went wrong";return{success:!0}}}else throw"Cannot finish assessment"},async startToolChecklist(){const{data:t}=await g.upsertRecordsXML(this.toolChecklistData);if(t[0])return this.toolListId=t[0][3],t[0];throw"Cannot start checklist"},async finishToolChecklist(){const{metadata:t}=await g.upsertRecordsXML({to:"bp3gcpk2w",data:[{3:{value:this.toolListId},18:{value:new Date},17:{value:"Complete"}}],mergeFieldId:3,fieldsToReturn:[3]});if(t.updatedRecordIds[0]){const{data:s}=await g.upsertRecordsXML(this.toolsData);if(s.length>0)return!0;throw"Cannot save tools"}else throw"Cannot finish tool checklist"},async submitToQB(){const{profile:t}=V(),{hiringCenter:s,testForCraft:e}=b(),{devEmployee:a}=A();this.testData.qb.testRecord[6].value=t[3].value,this.testData.qb.testRecord[13].value=s[3].value,this.testData.qb.testRecord[15].value=a[3],this.testData.qb.testRecord[17].value=e[15],this.testData.qb.testRecord[23].value=e[16],this.testData.qb.testRecord[34].value=Date.now(),this.testData.qb.testRecord[37].value="Complete";const o=[];return this.testData.completedQuestions.forEach(u=>{const i={6:{value:this.testData.qb.testRecord[3].value},7:{value:u[8]},11:{value:"Complete"},questionResponse:[{6:{value:0},8:{value:u.selection[3]}}]};o.push(i)}),this.testData.qb.testRecord.testQuestions=o,this.testData.qb.testRecord},async updateAssessment(t){return this.step=t.next,t.type==="tools"&&(this.tools=t.values),!0},updateStep(t){this.step=t},dataLoaded(){this.loading=!1},async getAllQuestions(){const{testForCraft:t}=b();if(this.questionsLoaded)return!0;if(t)try{const{data:s}=await g.fetchFromStructureApp({fields:[{6:{value:"bqamed7sr"},7:{value:"Table Query"},8:{value:`{'6'.EX.'${t[9]}'}`},9:{value:1},14:{value:17}}]});if(s)return s.forEach(async e=>{e[20]&&(e.hasImage=!0,e.imageData={src:e[22],alt:e[21]}),e[19].forEach(a=>{a.value=a[3],a.label=a[6]})}),this.testData.allQuestions=s,!0;throw"Something went wrong"}catch(s){console.log(s);const{data:e}=await g.doQuery({from:"bqamed7sr",where:`{'6'.EX.'${t[9]}'}`,select:[3,6,8,9,10,11,12,13,14,18,19,20,21,22,23,24],sortBy:[{fieldId:11,order:"ASC"}]});if(e)return e.forEach(async a=>{a[20]==="Yes"&&(a.hasImage=!0,a.imageData={src:a[22],alt:a[21]}),a[19]=await M.converter(a[19]),a[24]=await M.converter(a[24]),a[19].forEach(o=>{o.value=o[3],o.label=o[6]})}),this.testData.allQuestions=e,!0;throw"Something went wrong"}else throw"No test for craft"},async loadQuestionGroup(t,s){if(t!==void 0){const e=this.testData.allQuestions.filter(a=>a[23]===t);if(e.length>0)return e.length>5&&(e.length=5),e.forEach(a=>{a.response=null;const o=this.testData.allQuestions.findIndex(u=>u[3]===a[3]);o>-1&&this.testData.allQuestions.splice(o,1)}),this.testData.nextQuestions=e,this.testData.currentScope=t,this.testData.loadIteration=s,e;throw"There are no questions"}},async completeQuestion(t){const s=t.response,e=t[19].find(u=>u.value===s);if(e!==void 0)t.selection=e;else throw"No selection";t.iteration=this.testData.loadIteration,t.storedData={};const a={6:{value:this.testId},7:{value:t[8]},11:{value:"Complete"}};this.questions.push(a);const o={6:null,8:t.selection[3],link:t[8]};return this.answers.push(o),this.testData.completedQuestions.push(t),this.testData.nextQuestions=this.testData.nextQuestions.filter(u=>u[3]!==t[3]),{data:{nextQuestions:this.timeToStop?[]:this.testData.nextQuestions,scope:this.nextScope,iteration:this.nextIteration}}}}}),rt=E({components:{},setup(){const t=B(),{toolsForCraft:s,toolListInstructions:e,toolListName:a}=b(),{updateAssessment:o,startToolChecklist:u,finishToolChecklist:i}=q(),m=y([]),I=y(0);async function $(){await u(),I.value=1}async function T(){await o({next:1,type:"tools",values:m.value}),await i()&&t.replace({path:"/thanks"})}function k(p,C){console.log(p)}return O(m,(p,C)=>{console.log(p)}),{toolsForCraft:s,save:T,pushItem:k,selected:m,step:I,updateAssessment:o,toolListInstructions:e,start:$,toolListName:a}}}),ut={class:"row justify-center"},ct={class:"col-12 col-md-10 q-pt-sm"},dt={class:"text-h6 text-primary"},ht={class:"text-body1 text-dark"},pt=l("div",{class:"text-h6 text-dark"}," Tool Assessment ",-1),ft=l("div",{class:"text-body1 text-secondary text-italic"}," Please select the tools you own from the following list. ",-1),mt={class:"row justify-center"},vt={class:"row items-center"},gt={class:"col-11"},yt={class:"text-body1 text-primary"},wt={class:"col-1"},_t={class:"row q-pt-md"},bt={class:"col-12 text-right"};function Dt(t,s,e,a,o,u){return c(),w("div",null,[l("div",ut,[l("div",ct,[t.step===0?(c(),_(Q,{key:0,class:"q-mt-xl"},{default:r(()=>[n(d,null,{default:r(()=>[l("div",dt,D(t.toolListName),1)]),_:1}),n(d,null,{default:r(()=>[l("div",ht,D(t.toolListInstructions),1)]),_:1}),n(d,{class:"text-right"},{default:r(()=>[n(S,{color:"primary",label:"Continue",onClick:t.start},null,8,["onClick"])]),_:1})]),_:1})):h("",!0),t.step===1?(c(),_(Q,{key:1,flat:""},{default:r(()=>[n(d,null,{default:r(()=>[pt,ft]),_:1}),n(d,null,{default:r(()=>[l("div",mt,[(c(!0),w(Y,null,K(t.toolsForCraft,i=>(c(),w("div",{class:"col-12 col-md-6",key:i[3]},[n(Q,{class:"tool-card q-ma-sm"},{default:r(()=>[n(d,null,{default:r(()=>[n(W,{style:{"max-height":"150px"},fit:"scale-down",src:i[11]},null,8,["src"])]),_:2},1024),n(Z),n(d,null,{default:r(()=>[l("div",vt,[l("div",gt,[l("div",yt,D(i[8]),1)]),l("div",wt,[n(J,{modelValue:t.selected,"onUpdate:modelValue":s[0]||(s[0]=m=>t.selected=m),color:"primary",val:i.value},null,8,["modelValue","val"])])])]),_:2},1024)]),_:2},1024)]))),128))]),l("div",_t,[l("div",bt,[n(S,{color:"primary",onClick:t.save,label:"Continue"},null,8,["onClick"])])])]),_:1})]),_:1})):h("",!0)])])])}var Qt=F(rt,[["render",Dt]]);const Ct=E({components:{},setup(){const t=B(),s=y(0),{testForCraft:e,startLevelForTest:a}=b(),{getAllQuestions:o,questionsLoaded:u,loadQuestionGroup:i,completeQuestion:m,startAssessment:I,finishAssessment:$,updateAssessment:T}=q(),k=y(!0),p=y(null),C=y(null),v=y([]),N=y(!1),R=y(!1);tt(async()=>{u||await o(),k.value=!1,v.value=await i(a,1)});const L=et(()=>{const f=v.value?v.value.length:0,x=Math.floor(Math.random()*(f-0));return v.value&&v.value.length>0?v.value[x]:null});O(p,(f,x)=>{f&&(C.value=null)});async function z(){if(!p.value)C.value="Select an answer";else{R.value=!0,C.value=null,L.value.response=p.value;const{data:f}=await m(L.value);if(p.value=null,f.nextQuestions.length>0)v.value=f.nextQuestions,R.value=!1;else try{v.value=await i(f.scope,f.iteration),R.value=!1}catch{v.value=[];const{success:U}=await $();U&&e[18]==="Yes"?T({next:1}):t.replace({path:"/thanks"})}}}async function G(){N.value=!0;try{await I(),s.value=1}catch(f){console.log(f)}}return{step:s,testForCraft:e,loading:k,currentQuestion:L,response:p,responseError:C,submit:z,launchAssessment:G,starting:N,submitting:R}}}),kt={key:0,class:"row justify-center"},It={class:"col-12 col-md-10 q-pt-sm"},Rt={class:"text-h6 text-primary"},St={class:"text-body1 text-dark"},qt={class:"text-h5 text-primary"},$t={class:"q-pa-sm"},Tt={class:"text-body1 q-pb-md"},Lt=l("hr",null,null,-1),xt={key:0,class:"col-5 text-center"},At=["src","alt"],Et={key:1,class:"absolute-center"};function Ft(t,s,e,a,o,u){return c(),w("div",null,[t.loading?h("",!0):(c(),w("div",kt,[l("div",It,[t.step===0?(c(),_(Q,{key:0,class:"q-mt-xl"},{default:r(()=>[n(d,null,{default:r(()=>[l("div",Rt,D(t.testForCraft[29]),1)]),_:1}),n(d,null,{default:r(()=>[l("div",St,D(t.testForCraft[28]),1)]),_:1}),n(d,{class:"text-right"},{default:r(()=>[n(S,{color:"primary",label:"Continue",onClick:t.launchAssessment,loading:t.starting,disabled:t.starting},null,8,["onClick","loading","disabled"])]),_:1})]),_:1})):h("",!0),t.step===1?(c(),_(Q,{key:1,flat:""},{default:r(()=>[n(d,null,{default:r(()=>[l("div",qt,D(t.testForCraft[29]),1)]),_:1}),t.currentQuestion?(c(),_(d,{key:0},{default:r(()=>[n(Q,{flat:""},{default:r(()=>[n(d,null,{default:r(()=>[l("div",{class:X(t.currentQuestion.hasImage?"row justify-between items-start":"row justify-center items-start")},[l("div",{class:X(t.currentQuestion.hasImage?"col-6":"col-10")},[n(Q,null,{default:r(()=>[n(d,null,{default:r(()=>[l("div",$t,[l("div",Tt,[st(D(t.currentQuestion[9])+" ",1),t.responseError?(c(),_(at,{key:0,size:"md",class:"q-ml-sm",name:"error",color:"red"})):h("",!0)]),n(ot,{options:t.currentQuestion[19],type:"radio",modelValue:t.response,"onUpdate:modelValue":s[0]||(s[0]=i=>t.response=i)},null,8,["options","modelValue"])])]),_:1}),Lt,n(d,{class:"text-right"},{default:r(()=>[n(S,{color:"primary",label:"Submit",onClick:t.submit,loading:t.submitting,disabled:t.submitting},null,8,["onClick","loading","disabled"])]),_:1})]),_:1})],2),t.currentQuestion.hasImage?(c(),w("div",xt,[l("img",{class:"question-img",src:t.currentQuestion.imageData.src,alt:t.currentQuestion.imageData.alt},null,8,At)])):h("",!0)],2)]),_:1})]),_:1})]),_:1})):h("",!0)]),_:1})):h("",!0)])])),t.loading?(c(),w("div",Et,[n(P,{color:"primary",size:"5em"})])):h("",!0)])}var Nt=F(Ct,[["render",Ft]]);const Vt=E({components:{tools:Qt,test:Nt},setup(){const t=q(),{dataLoaded:s}=q(),{step:e,loading:a}=nt(t),{getCraftTools:o}=b();return o(),s(),{step:e,loading:a}}}),Mt={key:0,class:"row"},Xt={class:"col"},jt={key:1,class:"absolute-center"};function Bt(t,s,e,a,o,u){const i=j("tools"),m=j("test");return c(),_(lt,{class:"window-height window-width"},{default:r(()=>[t.loading?h("",!0):(c(),w("div",Mt,[l("div",Xt,[t.step===1?(c(),_(i,{key:0})):h("",!0),t.step===0?(c(),_(m,{key:1})):h("",!0)])])),t.loading?(c(),w("div",jt,[n(P,{color:"primary",size:"5em"})])):h("",!0)]),_:1})}var Pt=F(Vt,[["render",Bt]]);export{Pt as default};
